---
title: "Climate Distrubances Overview"
date: "`r Sys.Date()`"
output: 
  officedown::rpptx_document:
    reference_doc: pptx-template.pptx
    
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,
                      warning = FALSE,
                      message = FALSE, 
                      fig.width=12, 
                      fig.height = 6, 
                      dpi=300)

library(here)
library(tidyverse)
library(flextable)
library(extrafont)
library(targets)


# ## Flex table defaults
set_flextable_defaults(
  font.family = "Calibri", font.size = 28, font.color = "black",
  text.align = "left",
  table.layout = "fixed",
  theme_fun = "theme_booktabs")

if(.Platform$OS.type == "windows"){
  loadfonts(device = "win", quiet = TRUE)
}

theme_set(theme_minimal(base_family = "Calibri") %+replace%
            theme(plot.caption = element_text(face = "italic", hjust = 1),
                  plot.title.position = "plot",
                  panel.grid.major.x = element_blank(),
                  panel.grid.minor.x = element_blank(),
                  axis.title = element_text(size = 18),
                  axis.text = element_text(size = 14))
          )
```

## Which Climate Related Disturbance?
- Wildfires
- Heatwaves
- Flooding



## Wildfires
```{r}
tar_read(area_burned_over_time) %>% 
  mutate(FIRE_SIZE_SQKM = FIRE_SIZE_HECTARES/100) %>% 
  ggplot(aes(x = FIRE_YEAR, y = FIRE_SIZE_SQKM)) +
  geom_line() +
  labs(y = "Area Burned (km^2)") +
  theme(axis.title.x = element_blank())
```

## Wildfires

- Test
- Test

## Heatwaves - Provincial
```{r}
tar_read(heatwave_days_over_time) %>% 
  mutate(year = as.numeric(year)) %>% 
  filter(year > 1960) %>% 
  ggplot(aes(x = year, y = heatwave_days_per_station)) +
  geom_line() 
```

## Heatwaves - By LHA
```{r}
tar_read(heatwave_days_over_time_by_lha) %>% 
  mutate(year = as.numeric(year)) %>% 
  filter(year > 1960) %>% 
  ggplot(aes(x = year, y = heatwave_days_per_station)) +
  geom_line(aes(group = LOCAL_HLTH_AREA_NAME), colour = "grey80") +
  geom_smooth() +
  guides(colour = FALSE) +
  facet_wrap(~HLTH_AUTHORITY_NAME)
```

